<!DOCTYPE html>
<html lang="jp">
  <head>
    <meta charset="utf-8">
    <title>週間サービス計画書</title>
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link rel="stylesheet" type="text/css" href="/css/bootstrap.css">
    
    <link rel="stylesheet" type="text/css" href="/css/theme.css">
    <link rel="stylesheet" href="/css/font.css">

    <script src="/js/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="/js/jquery.autosize.min.js"></script>

    <script>
    window.onunload = function(){};
    history.forward();

	timed=[
		{"time":"04:00"},
		{"time":"04:10"},
		{"time":"04:20"},
		{"time":"04:30"},
		{"time":"04:40"},
		{"time":"04:50"},
		{"time":"05:00"},
		{"time":"05:10"},
		{"time":"05:20"},
		{"time":"05:30"},
		{"time":"05:40"},
		{"time":"05:50"},
		{"time":"06:00"},
		{"time":"06:10"},
		{"time":"06:20"},
		{"time":"06:30"},
		{"time":"06:40"},
		{"time":"06:50"},
		{"time":"07:00"},
		{"time":"07:10"},
		{"time":"07:20"},
		{"time":"07:30"},
		{"time":"07:40"},
		{"time":"07:50"},
		{"time":"08:00"},
		{"time":"08:10"},
		{"time":"08:20"},
		{"time":"08:30"},
		{"time":"08:40"},
		{"time":"08:50"},
		{"time":"09:00"},
		{"time":"09:10"},
		{"time":"09:20"},
		{"time":"09:30"},
		{"time":"09:40"},
		{"time":"09:50"},
		{"time":"10:00"},
		{"time":"10:10"},
		{"time":"10:20"},
		{"time":"10:30"},
		{"time":"10:40"},
		{"time":"10:50"},
		{"time":"11:00"},
		{"time":"11:10"},
		{"time":"11:20"},
		{"time":"11:30"},
		{"time":"11:40"},
		{"time":"11:50"},
		{"time":"12:00"},
		{"time":"12:10"},
		{"time":"12:20"},
		{"time":"12:30"},
		{"time":"12:40"},
		{"time":"12:50"},
		{"time":"13:00"},
		{"time":"13:10"},
		{"time":"13:20"},
		{"time":"13:30"},
		{"time":"13:40"},
		{"time":"13:50"},
		{"time":"14:00"},
		{"time":"14:10"},
		{"time":"14:20"},
		{"time":"14:30"},
		{"time":"14:40"},
		{"time":"14:50"},
		{"time":"15:00"},
		{"time":"15:10"},
		{"time":"15:20"},
		{"time":"15:30"},
		{"time":"15:40"},
		{"time":"15:50"},
		{"time":"16:00"},
		{"time":"16:10"},
		{"time":"16:20"},
		{"time":"16:30"},
		{"time":"16:40"},
		{"time":"16:50"},
		{"time":"17:00"},
		{"time":"17:10"},
		{"time":"17:20"},
		{"time":"17:30"},
		{"time":"17:40"},
		{"time":"17:50"},
		{"time":"18:00"},
		{"time":"18:10"},
		{"time":"18:20"},
		{"time":"18:30"},
		{"time":"18:40"},
		{"time":"18:50"},
		{"time":"19:00"},
		{"time":"19:10"},
		{"time":"19:20"},
		{"time":"19:30"},
		{"time":"19:40"},
		{"time":"19:50"},
		{"time":"20:00"},
		{"time":"20:10"},
		{"time":"20:20"},
		{"time":"20:30"},
		{"time":"20:40"},
		{"time":"20:50"},
		{"time":"21:00"},
		{"time":"21:10"},
		{"time":"21:20"},
		{"time":"21:30"},
		{"time":"21:40"},
		{"time":"21:50"},
		{"time":"22:00"},
		{"time":"22:10"},
		{"time":"22:20"},
		{"time":"22:30"},
		{"time":"22:40"},
		{"time":"22:50"},
		{"time":"23:00"},
		{"time":"23:10"},
		{"time":"23:20"},
		{"time":"23:30"},
		{"time":"23:40"},
		{"time":"23:50"},
		{"time":"00:00"},
		{"time":"00:10"},
		{"time":"00:20"},
		{"time":"00:30"},
		{"time":"00:40"},
		{"time":"00:50"},
		{"time":"01:00"},
		{"time":"01:10"},
		{"time":"01:20"},
		{"time":"01:30"},
		{"time":"01:40"},
		{"time":"01:50"},
		{"time":"02:00"},
		{"time":"02:10"},
		{"time":"02:20"},
		{"time":"02:30"},
		{"time":"02:40"},
		{"time":"02:50"},
		{"time":"03:00"},
		{"time":"03:10"},
		{"time":"03:20"},
		{"time":"03:30"},
		{"time":"03:40"},
		{"time":"03:50"},
		];

	youbid=[
		{"id":"1","youbi":"月","code":"mon"},
		{"id":"2","youbi":"火","code":"tue"},
		{"id":"3","youbi":"水","code":"wed"},
		{"id":"4","youbi":"木","code":"thu"},
		{"id":"5","youbi":"金","code":"fri"},
		{"id":"6","youbi":"土","code":"sat"},
		{"id":"0","youbi":"日","code":"sun"},
		];

	serviced=[
//              ###TENKAIDATA###
   		{ "id":"%1","service":"%2","everyweek":"%3", "youbi":"%4","start":"%5","end":"%6" },
//              ###TENKAIDATA###
		];

	dailyserviced=[
//              ###ASSESSMENTDAILY###
   		{ "id":"%1","service":"%2","start":"%3"},
//              ###ASSESSMENTDAILY###
		];



        var warekid=[
//              ###GENGOUMASTER###
                        {"id":"%1","value":"%2","year":"%3"},
//              ###GENGOUMASTER###
                ];
        
        var dataArrCSVWeeklyId=new Array();
        var dataArrCSVWeeklyService=new Array();
        var dataArrCSVWeeklyEveryweek=new Array();
        var dataArrCSVWeeklyYoubi=new Array();
        var dataArrCSVWeeklyStart=new Array();
        var dataArrCSVWeeklyEnd=new Array();
        var dataArrCSVDailyId=new Array();
        var dataArrCSVDailyService=new Array();
        var dataArrCSVDailyStart=new Array();

        if(serviced.length>0) {
            for(ws in serviced) {
                dataArrCSVWeeklyId.push(serviced[ws].id);
                dataArrCSVWeeklyService.push(serviced[ws].service);
                dataArrCSVWeeklyEveryweek.push(serviced[ws].everyweek);
                dataArrCSVWeeklyYoubi.push(serviced[ws].youbi.replace(/,/g,"/"));
                dataArrCSVWeeklyStart.push(serviced[ws].start);
                dataArrCSVWeeklyEnd.push(serviced[ws].end);
            }
        }

        if(dailyserviced.length>0){
            for(ds in dailyserviced) {
                dataArrCSVDailyId.push(dailyserviced[ds].id);
                dataArrCSVDailyService.push(dailyserviced[ds].service);
                dataArrCSVDailyStart.push(dailyserviced[ds].start);
            }
        }

        function registWeeklyPop(id,weekyoubi,starttime,endtime,naiyou) {
            ###RETURNFORM### ###RETURNFALSE###
//            window.open("about:blank",'weeklyservicewindow','width=756, height=300, menubar=no, toolbar=no, scrollbars=no');
            $('#WEEKLYSERVICE_ID').val(id);
            $('#YOUBI').val(weekyoubi);
            $('#START').val(starttime);
            $('#END').val(endtime);
            $('#NAIYOU').val(naiyou);
            document.frmWeekly.target="weeklyservicewindow";
            document.frmWeekly.submit();
        }

        function registDailyPop(id,starttime,naiyou) {
            ###RETURNFORM### ###RETURNFALSE###
//            window.open("about:blank",'dailyservicewindow','width=756, height=300, menubar=no, toolbar=no, scrollbars=no');
            $('#DAILYSERVICE_ID').val(id);
            $('#START_DAILY').val(starttime);
            $('#NAIYOU_DAILY').val(naiyou);
            document.frmDaily.target="dailyservicewindow";
            document.frmDaily.submit();
        }


	jQuery(function(){
		//施設リストプルダウンの「本社」を非表示
		var shisetsuList = $(".shisetsulist a").get();
		var shisetsuListLength = shisetsuList.length;
		for (var i=0; i<shisetsuList.length; i++) {
			var shisetsuListObj = $(shisetsuList).get(i);
			if ($(shisetsuListObj).text() == "本社") {
				$(shisetsuListObj).parent().css("display", "none");
				shisetsuListLength -= 1; 
			}
		}
		//施設リストプルダウンの中身が0個の場合、吹き出しを非表示
		if (shisetsuListLength == 0) {
			$("#shisetsuList_ul").css("display", "none");
		}
        // メニュー上のボタン制御
        $("#home").click(function(){
            document.frmBack.submit();
        });

        $("#regist").click(function(){
            $("#frmWhole [name=MODE]").val("regist");
            $('#WeeklyId').val(dataArrCSVWeeklyId);
            $('#WeeklyService').val(dataArrCSVWeeklyService);
            $('#WeeklyEveryweek').val(dataArrCSVWeeklyEveryweek);
            $('#WeeklyYoubi').val(dataArrCSVWeeklyYoubi);
            $('#WeeklyStart').val(dataArrCSVWeeklyStart);
            $('#WeeklyEnd').val(dataArrCSVWeeklyEnd);
            $('#DailyId').val(dataArrCSVDailyId);
            $('#DailyService').val(dataArrCSVDailyService);
            $('#DailyStart').val(dataArrCSVDailyStart);
            $('#SpotService').val($('#noweekservice').val());
            document.frmWhole.target="_self";
            document.frmWhole.submit();
        });

        $("#Hyouji").click(function(){
            $("#frmMenuWeekplan [name=MODE]").val("search");
            frmMenuWeekplan.target="_self";
            frmMenuWeekplan.action="WEEKPLAN_KAIGO.CGI";
            frmMenuWeekplan.method="POST";
            frmMenuWeekplan.submit();            
        });

        $("#print").click(function(){
            $("#frmMenuWeekplan [name=MODE]").val("print");
            frmMenuWeekplan.target="printwindow";
            frmMenuWeekplan.action="WEEKPLAN_KAIGO.CGI";
            frmMenuWeekplan.method="POST";
            frmMenuWeekplan.submit();
        });

        var curdate = new Date();
        var seirekiyear = curdate.getFullYear();
        var nextmonth = curdate.getMonth()+parseInt(1);

		$("#add").click(function(){
    		window.open('pop-route-input.html','routewindow','width=1024,height=300');
		});




    <!-- 表作成-->
		var htmlstr="<tr><th class=\"th-route-header\" style=\"border:1px solid #bbbbbb\"></th>";
		for(var j in youbid){
    		htmlstr=htmlstr+"<th style=\"width:10%\;border:1px solid #bbbbbb\">"+youbid[j].youbi+"</th>";
		}
		htmlstr=htmlstr+"<th style=\"border-left-width:3px;width:20%;border:1px solid #bbbbbb\">主な日常生活上の活動</th></tr>";
		
		for (var i in timed) {
			var tmptimeminutes=timed[i].time.split(":");
			var timeminutes=parseInt(tmptimeminutes[0]*60)+parseInt(tmptimeminutes[1]);
            if(tmptimeminutes[1]==10||tmptimeminutes[1]==20||tmptimeminutes[1]==30||tmptimeminutes[1]==40) {
                htmlstr=htmlstr+"<tr class=\"tr-route\"><td class=\"td-route-name\" style=\"border:1px solid #bbbbbb\;border-bottom:1px solid #ffffff\;border-top:1px solid #ffffff\"></td>";                 
            } else if(tmptimeminutes[1]==50) {
                htmlstr=htmlstr+"<tr class=\"tr-route\"><td class=\"td-route-name\" style=\"border:1px solid #bbbbbb\;border-top:1px solid #ffffff\"></td>";                
            } else {
                htmlstr=htmlstr+"<tr class=\"tr-route\"><td class=\"td-route-name\" style=\"border:1px solid #bbbbbb\;border-bottom:1px solid #ffffff\">"+timed[i].time+"</td>";
            }
    		for (var j in youbid) {
				htmlstr=htmlstr+"<td class=\"td-route-val\" style=\"border:1px solid #bbbbbb;\" onclick=\"registWeeklyPop('','"+youbid[j].code+"','"+tmptimeminutes[0]+'h'+tmptimeminutes[1]+"','')\">";
				htmlstr=htmlstr+"</td>";
			}
			
			htmlstr=htmlstr+"<td class=\"td-nichijo-val\" style=\"border:1px solid #bbbbbb\" onclick=\"registDailyPop('','"+tmptimeminutes[0]+'h'+tmptimeminutes[1]+"','')\"></td></tr>";

		}

		htmlstr=htmlstr+"<tr><td style=\"border-top-width:3px;border:1px solid #bbbbbb\">週単位以外のサービス</td><td style=\"border-top-width:3px;border:1px solid #bbbbbb\" colspan=\"8\"><textarea id='noweekservice' name='noweekservice' class='textareaautosize' style='width:100%' maxlength='150' placeholder='最大150文字'></textarea></td></tr>";
		
		$('#weekplan').children().remove();
		$('#weekplan').append(htmlstr);

        $('.textareaautosize').autosize();

	$("#tenkaijouhou").click(function(){
            $("#frmMenuWeekplan [name=MODE]").val("tenkai");
            frmMenuWeekplan.action="WEEKPLAN_KAIGO.CGI";
            frmMenuWeekplan.method="POST";
            frmMenuWeekplan.submit();
        });
		    
    <!-- 表作成-->
         if(serviced.length>0) {
		var htmlstr="<tr><th class=\"th-route-header\" style=\"border:1px solid #bbbbbb\"></th>";
		for(var j in youbid){
    		htmlstr=htmlstr+"<th style=\"width:10%;border:1px solid #bbbbbb\">"+youbid[j].youbi+"</th>";
		}
		htmlstr=htmlstr+"<th style=\"border-left-width:3px;width:20%;border:1px solid #bbbbbb\">主な日常生活上の活動</th></tr>";
		
		for (var i in timed) {
			var tmptimeminutes=timed[i].time.split(":");
			var timeminutes=parseInt(tmptimeminutes[0]*60)+parseInt(tmptimeminutes[1]);
            if(tmptimeminutes[1]==10||tmptimeminutes[1]==20||tmptimeminutes[1]==30||tmptimeminutes[1]==40) {
                htmlstr=htmlstr+"<tr class=\"tr-route\"><td class=\"td-route-name\" style=\"border:1px solid #bbbbbb\;border-bottom:1px solid #ffffff\;border-top:1px solid #ffffff\"></td>";                
            } else if(tmptimeminutes[1]==50) {
                htmlstr=htmlstr+"<tr class=\"tr-route\"><td class=\"td-route-name\" style=\"border:1px solid #bbbbbb\;border-top:1px solid #ffffff\"></td>";                
            } else {
                htmlstr=htmlstr+"<tr class=\"tr-route\"><td class=\"td-route-name\" style=\"border:1px solid #bbbbbb;border-bottom:1px solid #ffffff\">"+timed[i].time+"</td>";
            }
    		for (var j in youbid) {
                var checkflg="0";
				for (var k in serviced) {
					var tmpstarttimeminutes=serviced[k].start.split(":");
					var starttimeminutes=parseInt(tmpstarttimeminutes[0]*60)+parseInt(tmpstarttimeminutes[1]);
					var tmpendtimeminutes=serviced[k].end.split(":");
					var endtimeminutes=parseInt(tmpendtimeminutes[0]*60)+parseInt(tmpendtimeminutes[1]);
					if(youbid[j].id=="0"&&serviced[k].youbi.match(/0/)&&starttimeminutes<=timeminutes&&timeminutes<endtimeminutes&&serviced[k].everyweek=="1"){
                        htmlstr=htmlstr+"<td class=\"td-route-val\" style=\"\" onclick=\"registWeeklyPop('"+serviced[k].id+"','"+youbid[j].code+"','"+tmpstarttimeminutes[0]+'h'+tmpstarttimeminutes[1]+"','"+tmpendtimeminutes[0]+'h'+tmpendtimeminutes[1]+"','"+serviced[k].service+"')\">";
						htmlstr=htmlstr+serviced[k].service;
                        checkflg="1";
					}
					if(youbid[j].id=="1"&&serviced[k].youbi.match(/1/)&&starttimeminutes<=timeminutes&&timeminutes<endtimeminutes&&serviced[k].everyweek=="1"){
                        htmlstr=htmlstr+"<td class=\"td-route-val\" style=\"\" onclick=\"registWeeklyPop('"+serviced[k].id+"','"+youbid[j].code+"','"+tmpstarttimeminutes[0]+'h'+tmpstarttimeminutes[1]+"','"+tmpendtimeminutes[0]+'h'+tmpendtimeminutes[1]+"','"+serviced[k].service+"')\">";
						htmlstr=htmlstr+serviced[k].service;
                        checkflg="1";
					}
					if(youbid[j].id=="2"&&serviced[k].youbi.match(/2/)&&starttimeminutes<=timeminutes&&timeminutes<endtimeminutes&&serviced[k].everyweek=="1"){
                        htmlstr=htmlstr+"<td class=\"td-route-val\" style=\"\" onclick=\"registWeeklyPop('"+serviced[k].id+"','"+youbid[j].code+"','"+tmpstarttimeminutes[0]+'h'+tmpstarttimeminutes[1]+"','"+tmpendtimeminutes[0]+'h'+tmpendtimeminutes[1]+"','"+serviced[k].service+"')\">";
						htmlstr=htmlstr+serviced[k].service;
                        checkflg="1";
					}
					if(youbid[j].id=="3"&&serviced[k].youbi.match(/3/)&&starttimeminutes<=timeminutes&&timeminutes<endtimeminutes&&serviced[k].everyweek=="1"){
                        htmlstr=htmlstr+"<td class=\"td-route-val\" style=\"\" onclick=\"registWeeklyPop('"+serviced[k].id+"','"+youbid[j].code+"','"+tmpstarttimeminutes[0]+'h'+tmpstarttimeminutes[1]+"','"+tmpendtimeminutes[0]+'h'+tmpendtimeminutes[1]+"','"+serviced[k].service+"')\">";
						htmlstr=htmlstr+serviced[k].service;
                        checkflg="1";
					}
					if(youbid[j].id=="4"&&serviced[k].youbi.match(/4/)&&starttimeminutes<=timeminutes&&timeminutes<endtimeminutes&&serviced[k].everyweek=="1"){
                        htmlstr=htmlstr+"<td class=\"td-route-val\" style=\"\" onclick=\"registWeeklyPop('"+serviced[k].id+"','"+youbid[j].code+"','"+tmpstarttimeminutes[0]+'h'+tmpstarttimeminutes[1]+"','"+tmpendtimeminutes[0]+'h'+tmpendtimeminutes[1]+"','"+serviced[k].service+"')\">";
						htmlstr=htmlstr+serviced[k].service;
                        checkflg="1";
					}
					if(youbid[j].id=="5"&&serviced[k].youbi.match(/5/)&&starttimeminutes<=timeminutes&&timeminutes<endtimeminutes&&serviced[k].everyweek=="1"){
                        htmlstr=htmlstr+"<td class=\"td-route-val\" style=\"\" onclick=\"registWeeklyPop('"+serviced[k].id+"','"+youbid[j].code+"','"+tmpstarttimeminutes[0]+'h'+tmpstarttimeminutes[1]+"','"+tmpendtimeminutes[0]+'h'+tmpendtimeminutes[1]+"','"+serviced[k].service+"')\">";
						htmlstr=htmlstr+serviced[k].service;
                        checkflg="1";
					}
					if(youbid[j].id=="6"&&serviced[k].youbi.match(/6/)&&starttimeminutes<=timeminutes&&timeminutes<endtimeminutes&&serviced[k].everyweek=="1"){
                        htmlstr=htmlstr+"<td class=\"td-route-val\" style=\"\" onclick=\"registWeeklyPop('"+serviced[k].id+"','"+youbid[j].code+"','"+tmpstarttimeminutes[0]+'h'+tmpstarttimeminutes[1]+"','"+tmpendtimeminutes[0]+'h'+tmpendtimeminutes[1]+"','"+serviced[k].service+"')\">";
						htmlstr=htmlstr+serviced[k].service;
                        checkflg="1";
					}
				}
                if(checkflg=="0"){
                    htmlstr=htmlstr+"<td class=\"td-route-val\" style=\"\" onclick=\"registWeeklyPop('','"+youbid[j].code+"','"+tmptimeminutes[0]+'h'+tmptimeminutes[1]+"','','')\">";
                }
				htmlstr=htmlstr+"</td>";
			}
			
			var dailyservice="";
            var dailyserviceid="";
            var dailyservicetime="";
                        if (dailyserviced.length>0) {
			for (var p in dailyserviced) {
                                var dailyservicestart=("0"+dailyserviced[p].start).slice(-5);
				if(dailyservicestart==timed[i].time){
					dailyservice=dailyserviced[p].service;
                    dailyserviceid=dailyserviced[p].id;
                    dailyservicetime=dailyserviced[p].start;
                    break;
				}
			}
                        }
                        if(dailyserviceid !="") {
			htmlstr=htmlstr+"<td class=\"td-nichijo-val\" style=\"border:1px solid #bbbbbb\" onclick=\"registDailyPop('"+dailyserviceid+"','"+dailyservicetime+"','"+dailyservice+"')\">"+dailyservice+"</td></tr>";
                        } else {
			htmlstr=htmlstr+"<td class=\"td-nichijo-val\" style=\"border:1px solid #bbbbbb\" onclick=\"registDailyPop('','"+tmptimeminutes[0]+"h"+tmptimeminutes[1]+"','')\"></td></tr>";
                        }

		}

		var noteveryweekservice="";
		for (var o in serviced) {
			if(serviced[o].everyweek=="0"){
				if(noteveryweekservice!="") {
					noteveryweekservice=noteveryweekservice+","+serviced[o].service;
				} else {
					noteveryweekservice=noteveryweekservice+serviced[o].service;
				}
			}
		}

		htmlstr=htmlstr+"<tr><td style=\"border-top-width:3px;border:1px solid #bbbbbb\">週単位以外のサービス</td><td style=\"border-top-width:3px;border:1px solid #bbbbbb\" colspan=\"8\"><textarea id='noweekservice' name='noweekservice' class='textareaautosize' style='width:100%' maxlength='150' placeholder='最大150文字'>"+noteveryweekservice+"</textarea></td></tr>";
		
		$('#weekplan').children().remove();
		$('#weekplan').append(htmlstr);

                setFormat();
                $('.textareaautosize').autosize();
        } else if(dailyserviced.length>0) {
                var htmlstr="<tr><th class=\"th-route-header\" style=\"border:1px solid #bbbbbb\"></th>";
                for(var j in youbid){
                htmlstr=htmlstr+"<th style=\"width:10%\;border:1px solid #bbbbbb\">"+youbid[j].youbi+"</th>";
                }
                htmlstr=htmlstr+"<th style=\"border-left-width:3px;width:20%;border:1px solid #bbbbbb\">主な日常生活上の活動</th></tr>";

                for (var i in timed) {
                        var tmptimeminutes=timed[i].time.split(":");
                        var timeminutes=parseInt(tmptimeminutes[0]*60)+parseInt(tmptimeminutes[1]);
            if(tmptimeminutes[1]==10||tmptimeminutes[1]==20||tmptimeminutes[1]==30||tmptimeminutes[1]==40) {
                htmlstr=htmlstr+"<tr class=\"tr-route\"><td class=\"td-route-name\" style=\"border:1px solid #bbbbbb\;border-bottom:1px solid #ffffff\;border-top:1px solid #ffffff\"></td>";
            } else if(tmptimeminutes[1]==50) {
                htmlstr=htmlstr+"<tr class=\"tr-route\"><td class=\"td-route-name\" style=\"border:1px solid #bbbbbb\;border-top:1px solid #ffffff\"></td>";                
            } else {
                htmlstr=htmlstr+"<tr class=\"tr-route\"><td class=\"td-route-name\" style=\"border:1px solid #bbbbbb\;border-bottom:1px solid #ffffff\">"+timed[i].time+"</td>";
            }
                for (var j in youbid) {
                                htmlstr=htmlstr+"<td class=\"td-route-val\" style=\"border:1px solid #bbbbbb;\" onclick=\"registWeeklyPop('','"+youbid[j].code+"','"+tmptimeminutes[0]+'h'+tmptimeminutes[1]+"','')\">";
                                htmlstr=htmlstr+"</td>";
                        }
                        var dailyservice="";
            var dailyserviceid="";
            var dailyservicetime="";
                        for (var p in dailyserviced) {
                                var dailyservicestart=("0"+dailyserviced[p].start).slice(-5);
                                if(dailyservicestart==timed[i].time){
                                        dailyservice=dailyserviced[p].service;
                    dailyserviceid=dailyserviced[p].id;
                    dailyservicetime=dailyserviced[p].start;
                    break;
                                }
                        }
                        if(dailyserviceid !="") {
                        htmlstr=htmlstr+"<td class=\"td-nichijo-val\" style=\"border:1px solid #bbbbbb\" onclick=\"registDailyPop('"+dailyserviceid+"','"+dailyservicetime+"','"+dailyservice+"')\">"+dailyservice+"</td></tr>";
                        } else {
                        htmlstr=htmlstr+"<td class=\"td-nichijo-val\" style=\"border:1px solid #bbbbbb\" onclick=\"registDailyPop('','"+tmptimeminutes[0]+"h"+tmptimeminutes[1]+"','')\"></td></tr>";
                        }

                }
                htmlstr=htmlstr+"<tr><td style=\"border-top-width:3px;border:1px solid #bbbbbb\">週単位以外のサービス</td><td style=\"border-top-width:3px;border:1px solid #bbbbbb\" colspan=\"8\"><textarea id='noweekservice' name='noweekservice' class='textareaautosize' style='width:100%' maxlength='150' placeholder='最大150文字'></textarea></td></tr>";

                $('#weekplan').children().remove();
                $('#weekplan').append(htmlstr);

                setFormat();
                $('.textareaautosize').autosize();
        }

        function setFormat() {
        <!-- 同じセルの値が続く場合は空白が入り続け、"continuous-nyukyosha"classが設定される -->
            var strtmp= new Array();
            var flgtmp= new Array();

            $('#weekplan tr').each(function(i){
		        var len=$('td',this).length;
			    var thistr;
                for(j=1;j<=len; j++) {
                    if($('td',this).eq(j).text() != "") {
                        $('td',this).eq(j).addClass('continuous-nyukyosha');
                    }

                    if(flgtmp[j] == '0' || flgtmp[j] == null) {
					    thistr=$('#weekplan tr').eq(i-1);
                        strtmp[j]=$('td',thistr).eq(j).text();
                    }

                    if($('td',this).eq(j).text() == strtmp[j] && $('td',this).eq(j).text() != "") {
                        $('td',this).eq(j).text('');
                        $('td',this).eq(j).addClass('continuous-nyukyosha');
                        $('td',this).eq(j).css({'border-top':'solid 1px aqua'});
                        $('td',this).eq(j).css({'border-right':'solid 1px #bbbbbb'});
                        $('td',this).eq(j).css({'border-left':'solid 1px #bbbbbb'});
                        flgtmp[j]='1';
                    } else {
                        $('td',this).eq(j).css({'border-top':'solid 1px #bbbbbb'});
                        $('td',this).eq(j).css({'border-right':'solid 1px #bbbbbb'});
                        $('td',this).eq(j).css({'border-left':'solid 1px #bbbbbb'});
                        flgtmp[j]='0';
                    }
                }
            });
    <!-- 同じセルの値が続く場合は空白が入り続ける -->

        }

        weekplanspotservice="###NOWEEKSERVICE###";
        if(weekplanspotservice!="") {
           $('#noweekservice').val(weekplanspotservice);
        }
        $('.textareaautosize').autosize();


	});


                $('.shisetsulist').live('mouseover',function(){
                   this.style.backgroundColor="lightgrey";
                });
                $('.shisetsulist').live('mouseout',function(){
                   this.style.backgroundColor="white";
                });

    </script>


    <!-- Demo page code -->

    <style type="text/css">
        #line-chart {
            height:300px;
            width:800px;
            margin: 0px auto;
            margin-top: 1em;
        }
        .td-route-name {
            height:14px;
            font-size:12px;
            line-height:0px;
        }
        .td-route-val {
            height:14px;
        }
        .td-nichijo-val {
            height:14px;
        }
        .tr-route {
            height:14px;
        }
    </style>

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="lib/html5.js"></script>
    <![endif]-->

  </head>

  <!--[if lt IE 7 ]> <body class="ie ie6"> <![endif]-->
  <!--[if IE 7 ]> <body class="ie ie7 "> <![endif]-->
  <!--[if IE 8 ]> <body class="ie ie8 "> <![endif]-->
  <!--[if IE 9 ]> <body class="ie ie9 "> <![endif]-->
  <!--[if (gt IE 9)|!(IE)]><!--> 
  <body class=""> 
  <!--<![endif]-->
    
    <div class="navbar">
        <div class="navbar-inner">
                <ul class="nav pull-right">
                    <li id="fat-menu2">
                            <a tabindex="-1" href="/E-LIFE/SYSTEM_SETTEI/cgi-bin/SIGN_IN.CGI">ログアウト</a>
                    </li>

                </ul>
                <ul class="nav pull-right">

                    <li id="fat-menu" class="dropdown">
                        <a href="#" role="button" class="dropdown-toggle" data-toggle="dropdown">
<!-- ###USER__NAME### -->
                            <i class="icon-user"></i> %1
<!-- ###USER__NAME### -->
                        </a>

                    </li>

                </ul>
                <ul class="nav pull-right">
                    <li id="fat-menu3" class="dropdown on">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" tabindex="-1">###SELECT_SHISETSU###<i class="icon-caret-down"></i> </a>

                        <ul id="shisetsuList_ul" class="dropdown-menu" style="z-index:1000">
<!-- ###SHISETSU_TAISHOU### -->
                            <li class="shisetsulist on"><a href="javascript:Post('###USERID###','###PASSWORD###','%1','/E-LIFE/SYSTEM_SETTEI/cgi-bin/LOGIN.CGI')">%2</a></li>
<!-- ###SHISETSU_TAISHOU### -->
                        </ul>
                    </li>
                </ul>
                <font class="brand"><span style="position:relative; top:-4px; padding-left:6px;"><img src="/images/HSS_LOGO_COLOR2.png" alt="HSSマーク" width="290" height="26"></span><span style="position:relative; top:-2px;">開発環境</span></font>
        </div>
    </div>
    

    <!-- メニューバーここから -->


    <!-- メニューバーここまで -->
        
    <div class="header">
        <h1 class="page-title">週間サービス計画</h1>
    </div>

	<div class="row-fluid">
           <form id="frmMenuWeekplan" name="frmMenuWeekplan">
		<table style="margin-left:2em;min-width:1024px;"><tr>
		    <td style="width:30%;">利用者名：<font style="font-size:20px"><b>###RIYOUSHAMEI###</b></font>
			</td>
                   <td style="width:20%;">
                        </td>
                        <td style="width:10%;"><button id="Hyouji" name="Hyouji" type="button" class="btn btn-blue"><i class="icon-search"></i> 検索</button>
                        </td>

			<td style="width:10%;"><button id="tenkaijouhou" style="vertical-align:center;" type="button" >展開情報反映</button>

                        <input type="hidden" name="MODE" class="MODE" value="" />
                        <input type="hidden" name="Riyoushaid" value="###RIYOUSHAID###" />
                        <input type="hidden" name="USER_ID" value="###USERID###" />
                        <input type="hidden" name="KeikakuSakuseiDate" value="###KEIKAKUSAKUSEIDATE###" />
                        <input type="hidden" name="hdKeikakuSakuseiDate" value="###HDKEIKAKUSAKUSEIDATE###" >
                        <input type="hidden" name="userid"  value="###USERID###" />
                        <input type="hidden" name="password" value="###PASSWORD###" />
                        <input type="hidden" name="shisetsu" value="###SHISETSUID###" />
                        <input type="hidden" name="hdkensakudate" value=###HDKENSAKUDATE### >
                        <input type="hidden" name="hdShisetsuKensaku" value="###HDSHISETSUKENSAKU###" />
                        <input type="hidden" name="hdCaremanagerKensaku" value="###HDCAREMANAGERKENSAKU###" />
                        </td>
			</td>
		         <td style="text-align:right;">
					<div class="btn-toolbar">
					  <button class="btn btn-pink" id="regist" name="regist" style="display:###TOUROKUDISP###" type="button"><i class="icon-edit"></i> 登録</button>
					  <button class="btn btn-green" id="print" style="display:###PRINTDISP###"><i class="icon-print" ></i> 印刷</button>
                      <button id="home" name="home" class="btn btn-move" type="button" ><i class="icon-home" type="button"></i> 戻る</button>
					</div>
				</td>
				<input type="hidden" id="dataCsvEventRiyoushaId" name="dataCsvEventRiyoushaId" value="">
		</tr></table>
            </form>
	</div>

    <div class="container-fluid">
		<div class="well"style="min-width:1024px;">
				<div class="row-fluid">
			        <div id='plan' style="height:650px; overflow-y:auto">
                   <table style="width:1000px;margin-top:1em;">
                     <tr>
                        <td style="margin-top:.5em;border:1px solid #bbbbbb;padding:0px 10px 0px 10px;width:8%">第３表</td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;width:25%;text-align:left"></td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;width:7%;text-align:left"></td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;text-align:left;" rowspan="2"><font style="font-size:20px">週間サービス計画表</font></td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;width:26%;">作成年月日　<input id="KeikakuSakuseiDate" name="KeikakuSakuseiDate" type="text" value="###KEIKAKUSAKUSEIDATE###" style="width:130px;" readonly></td>
                     </tr>
                     <tr>
<!--                      ###RIYOUSHAKIHON###               -->
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;width:8%"></td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border-bottom:1px solid #000000;width:25%;text-align:left">利用者名&nbsp;&nbsp;&nbsp;&nbsp;<b><font>%1</font>様</b></td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;text-align:left;"></td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;width:26%;"></td>
<!--                      ###RIYOUSHAKIHON###               -->
                     </tr>
                   </table>
						<table class="" id='weekplan' style="margin-top:1em;margin-bottom:1em;width:1000px"></table>
			        </div>
				</div>
        </div>
	</div>
    

    <form name="frmWeekly" id="frmWeekly" method="POST" action="POP_WEEKPLAN_WEEKLYSERVICE_INPUT.CGI" >
       <input type="hidden" id="Riyoushaid" name="Riyoushaid" value="###RIYOUSHAID###" />
       <input type="hidden" id="USER_ID" name="USER_ID" value="###USERID###" />
       <input type="hidden" id="WEEKLYSERVICE_ID" name="WEEKLYSERVICE_ID" value="" />
       <input type="hidden" id="hdKeikakuSakuseiDate" name="hdKeikakuSakuseiDate" value="###HDKEIKAKUSAKUSEIDATE###" />
       <input type="hidden" id="YOUBI" name="YOUBI" value="" />
       <input type="hidden" id="START" name="START" value="" />
       <input type="hidden" id="END" name="END" value="" />
       <input type="hidden" id="NAIYOU" name="NAIYOU" value="" />
       <input type="hidden" id="MODE" name="MODE" class="MODE" value="init" />
       <input type="hidden" name="userid"  value="###USERID###" />
       <input type="hidden" name="password" value="###PASSWORD###" />
       <input type="hidden" name="shisetsu" value="###SHISETSUID###" />
       <input type="hidden" name="KeikakuSakuseiDate" value="###KEIKAKUSAKUSEIDATE###" >
       <input type="hidden" name="hdkensakudate" value=###HDKENSAKUDATE### >
    </form>


    <form name="frmDaily" id="frmDaily" method="POST" action="POP_WEEKPLAN_DAILYSERVICE_INPUT.CGI" >
       <input type="hidden" id="Riyoushaid" name="Riyoushaid" value="###RIYOUSHAID###" />
       <input type="hidden" id="USER_ID" name="USER_ID" value="###USERID###" />
       <input type="hidden" id="DAILYSERVICE_ID" name="DAILYSERVICE_ID" value="" />
       <input type="hidden" id="hdKeikakuSakuseiDate" name="hdKeikakuSakuseiDate" value="###HDKEIKAKUSAKUSEIDATE###" />
       <input type="hidden" id="START_DAILY" name="START_DAILY" value="" />
       <input type="hidden" id="NAIYOU_DAILY" name="NAIYOU_DAILY" value="" />
       <input type="hidden" id="MODE" name="MODE" class="MODE_DAILY" value="init" />
       <input type="hidden" name="userid"  value="###USERID###" />
       <input type="hidden" name="password" value="###PASSWORD###" />
       <input type="hidden" name="shisetsu" value="###SHISETSUID###" />
       <input type="hidden" name="KeikakuSakuseiDate" value="###KEIKAKUSAKUSEIDATE###" >
       <input type="hidden" name="hdkensakudate" value=###HDKENSAKUDATE### >
    </form>

    <form name="frmWhole" id="frmWhole" method="POST" action="WEEKPLAN_KAIGO.CGI" >
       <input type="hidden" id="Riyoushaid" name="Riyoushaid" value="###RIYOUSHAID###" />
       <input type="hidden" id="USER_ID" name="USER_ID" value="###USERID###" />
       <input type="hidden" id="hdKeikakuSakuseiDate" name="hdKeikakuSakuseiDate" value="###HDKEIKAKUSAKUSEIDATE###" />
       <input type="hidden" id="WeeklyId" name="WeeklyId" value="" />
       <input type="hidden" id="WeeklyService" name="WeeklyService" value="" />
       <input type="hidden" id="WeeklyEveryweek" name="WeeklyEveryweek" value="" />
       <input type="hidden" id="WeeklyYoubi" name="WeeklyYoubi" value="" />
       <input type="hidden" id="WeeklyStart" name="WeeklyStart" value="" />
       <input type="hidden" id="WeeklyEnd" name="WeeklyEnd" value="" />
       <input type="hidden" id="DailyId" name="DailyId" value="" />
       <input type="hidden" id="DailyService" name="DailyService" value="" />
       <input type="hidden" id="DailyStart" name="DailyStart" value="" />
       <input type="hidden" id="SpotService" name="SpotService" value="" />
       <input type="hidden" id="MODE" name="MODE" class="MODE" value="" />
       <input type="hidden" name="userid"  value="###USERID###" />
       <input type="hidden" name="password" value="###PASSWORD###" />
       <input type="hidden" name="shisetsu" value="###SHISETSUID###" />
       <input type="hidden" name="KeikakuSakuseiDate" value="###KEIKAKUSAKUSEIDATE###" >
       <input type="hidden" name="hdkensakudate" value=###HDKENSAKUDATE### >
       <input type="hidden" name="hdShisetsuKensaku" value="###HDSHISETSUKENSAKU###" />
       <input type="hidden" name="hdCaremanagerKensaku" value="###HDCAREMANAGERKENSAKU###" />
    </form>

    <form id="frmBack" name="frmBack" action="KYOTAKUSHIEN_CAREPLAN_MENU.CGI" method="POST">
       <input type="hidden" name="Riyoushaid" value="###RIYOUSHAID###" >
       <input type="hidden" name="USER_ID" value="###USERID###" >
       <input type="hidden" name="MODE" value="init" >
       <input type="hidden" name="hdKeikakuSakuseiDate" value="###HDKEIKAKUSAKUSEIDATE###" >
       <input type="hidden" name="KeikakuSakuseiDate" value="###KEIKAKUSAKUSEIDATE###" >
       <input type="hidden" name="hdkensakudate" value=###HDKENSAKUDATE### >
       <input type="hidden" name="userid"  value="###USERID###" />
       <input type="hidden" name="password" value="###PASSWORD###" />
       <input type="hidden" name="shisetsu" value="###SHISETSUID###" />
       <input type="hidden" name="hdShisetsuKensaku" value="###HDSHISETSUKENSAKU###" />
       <input type="hidden" name="hdCaremanagerKensaku" value="###HDCAREMANAGERKENSAKU###" />
    </form>

       <form action="" method="post" name="formlink">
           <input type="hidden" name="userid">
           <input type="hidden" name="password">
           <input type="hidden" name="cgi">
           <input type="hidden" name="shisetsu">
       </form>
    <script type="text/javascript">
        function Post(md,tx,shisetsu,url) {
            formlink.userid.value = md;
            formlink.password.value = tx;
            formlink.shisetsu.value = shisetsu;
            formlink.action=url;
            formlink.cgi.value = url;
            formlink.submit();
        }
    </script>

    <script src="/js/bootstrap.js"></script>
    <script type="text/javascript">
        $("[rel=tooltip]").tooltip();
        $(function() {
            $('.demo-cancel-click').click(function(){return false;});
        });
    </script>
    
  </body>
</html>


