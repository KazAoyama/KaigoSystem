<!DOCTYPE html>
<html lang="jp">
  <head>
    <meta charset="utf-8">
    <title>サービス利用票</title>
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link rel="stylesheet" type="text/css" href="###DOMAIN###/css/bootstrap.css">
    
    <link rel="stylesheet" href="###DOMAIN###/css/font.css">
    <script src="###DOMAIN###/js/jquery-1.7.2.min.js" type="text/javascript"></script>
	<script>
// 週、曜日指定の繰り返しデータ設定
//	serviced=[
//	   		{ "jigyoushatype":"11","id":"2013","week":"1,2,3,4,5","everyweek":"1", "youbi":"1,2,3,4,5,6","start":"16:30","end":"17:30","kyoukyusha":"0001","hoken":"1","plusfee":"100" },
//	   		{ "jigyoushatype":"11","id":"2073","week":"1,2,3,4,5","everyweek":"1", "youbi":"1,3,5","start":"18:30","end":"20:00","kyoukyusha":"0001","hoken":"1","plusfee":"0" },
//	   		{ "jigyoushatype":"13","id":"1501","week":"1,3,5","everyweek":"0", "youbi":"0","start":"9:30","end":"21:30","kyoukyusha":"0002","hoken":"1","plusfee":"0" },
//	   		{ "jigyoushatype":"15","id":"1242","week":"1,3,5","everyweek":"0", "youbi":"2","start":"18:30","end":"22:30","kyoukyusha":"0003","hoken":"0","plusfee":"200" }
//		];

// 展開情報設定
	serviced=[
//                ###TENKAIDATA###
	   		{ "jigyoushatype":"%2","id":"%3","weekyoubi":"%4","start":"%5","end":"%6","kyoukyusha":"%7","hoken":"%8","plusfee":"%9","firsttani":"%10" },
//                ###TENKAIDATA###
		];



// 作成済み表示＆実績あれば含み（対象月と利用者IDで検索）
//  事業者タイプ、サービス区分、実績確定区分、予定データ値、実績データ値、サービス開始時間、サービス終了時間、供給者ID、保険区分、付随費用
	sakuseid=[
//                ###RIYOUHYOUDATA###
	   		{ "jigyoushatype":"%2","id":"%3","jissekikakutei":"%4","yoteidate":"%5","jissekidate":"%6","start":"%7","end":"%8","kyoukyusha":"%9","hoken":"%10","plusfee":"%11","firsttani":"%12" },
//                ###RIYOUHYOUDATA###
		];


	// データセット部
	// サービス区分（サービスコード種類、サービスコード区分、サービス名、最小時間、最大時間、対象介護度、対象事業規模、対象事業者種類、サ責、同一建物、朝夜、深夜、単位）
	kaigoservice=[
//                     ###SERVICECODE###
                {"jigyoushatype":"%1","id":"%2","value":"%3","min":"%4","max":"%5","kaigodo":"%6","scale":"%7","facilitytype":"%8","servicemanager":"%9","douitsu":"%10","asayoru":"%11","shinya":"%12","fee":"%13","ketsuin":"%14","facilityunit":"%15","nightcare":"%16","calcunit":"%17"},
//                     ###SERVICECODE###
		];


	// 供給者データ（供給者ID、供給者名、提供サービスコード種類、事業規模、事業種類、特定事業所加算倍率、サービス提供責任者２級フラグ）
	kyoukyusha=[
//                     ###KYOUKYUSHA###
                 {"id":"%1","value":"%2","jigyoushatype":"%3","scale":"%4","facilitytype":"%5","areatanka":"%6","servicemanager":"%7","douitsu":"%8","ketsuin":"%9","facilityunit":"%10","nightcare":"%11"},
//                     ###KYOUKYUSHA###
		];


	kijundated=[
			{"id":"12111820130721","value":"20130721"},
			{"id":"12111820130803","value":"20130803"},
		];

    // preafterkbn 0:同じ 1:前 2:後
	youkaigodod=[
//                       ###KAIGODOJOUHOU###
			{"youkaigo":"%1","riyougendo":"%2","kaigodo":"%3","preafterkbn":"%4","kirikaebi":"%5","lightkaigodo":"%6"},
//                       ###KAIGODOJOUHOU###
		];

	// 地域単価
	areatanka=10.1;

	var YoubiDay= new Array("日","月","火","水","木","金","土");

        var warekid=[
//                     ###TAISHOUWAREKI###
                        {"id":"%1","value":"%2","year":"%3"},
//                     ###TAISHOUWAREKI###
                ];

	var dataArrEventRiyoushaId = new Array();



//  テーブルレコード数
    var numRecord=0;



//  予定データ（テーブル、日）
    var dataArrayYotei= new Array();

//  実績データ（テーブル、日）
    var dataArrayJisseki= new Array();

//  エラーメッセージ
    var error_msg="";

	jQuery(function(){
        // メニュー上のボタン制御
        $("#home").click(function(){
            $('*[name="hdTaishouMonth"]').val($('#taishoumonth').val());
            document.frmBack.submit();
        });

        var realdate = new Date();
        var realseirekiyear = realdate.getFullYear();        
        var curdate = new Date(###TAISHOUMONTH###);
        var seirekiyear = curdate.getFullYear();
        var nextmonth = curdate.getMonth()+parseInt(1);
        if(nextmonth>12){
            nextmonth=1;
        }
        for(var m=1; m<13; m++) {
            if(m==nextmonth) {
	        $("#taishoumonth").html(m);
                break;
            }
        }

        var minusyear=0;
        var warekimei="";
        for(var w in warekid) {
            if(warekid[w].id=='05') {
                minusyear=warekid[w].year;
                warekimei=warekid[w].value;
                break;
            }
        }
       
        var plusyear=0; 
        var curyear=seirekiyear-minusyear;
        var realyear=realseirekiyear-minusyear;
        var nextyear = realyear+parseInt(1);
        $("#taishouyear").html(realyear)
        $("#taishouwareki").html(warekimei);

        if(youkaigodod.length>0) {
	        if(youkaigodod[0].preafterkbn=="0") {
	            $('#DispKirikae').hide();
	        } else if (youkaigodod[0].preafterkbn=="1") {
	            var strkirikae="＊"+youkaigodod[0].kirikaebi+"日より前は"+youkaigodod[0].lightkaigodo;
	            $('#DispKirikae').show();
	            $('#DispKirikae').text(strkirikae);
	        } else {
	            var strkirikae="＊"+youkaigodod[0].kirikaebi+"日より後は"+youkaigodod[0].lightkaigodo;
	            $('#DispKirikae').show();
	            $('#DispKirikae').text(strkirikae);            
	        }

	        $('#Youkaigodo').html(youkaigodod[0].youkaigo);
	        $('#RiyouGendo').html(youkaigodod[0].riyougendo);
	}

		var date = new Date(###TAISHOUMONTH###);
		var d = date.getDate();
		var m = date.getMonth();
		var y = date.getFullYear();

//　ヘッダー作成
//		var htmlhd="<thead><tr><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">提供時間帯</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">サービス事業所名</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">サービス内容</th><th style=\"text-align:center; border:#bbbbbb solid 1px;width:3%;\" rowspan=\"2\">保険対象</th><th style=\"text-align:center; border:#bbbbbb solid 1px;width:3%;\" rowspan=\"2\">実績確定</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" >日付</th>";
		var htmlhd="<thead><tr><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">提供時間帯</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">サービス事業所名</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">サービス内容</th><th style=\"text-align:center; border:#bbbbbb solid 1px;width:3%;\" rowspan=\"2\">保険対象</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" >日付</th>";

		var tm = m+1;
		var NumOfDays= new Date(y,tm,0).getDate();
		var yd=1;
		var wn=1;
		var yoteigoukei=0;
                var yoteifuzui=0;
		var yoteinokori=0;
        var jissekigoukei=0;
        var jissekifuzui=0;

//　ヘッダーの日付
    	for (yd; yd<=NumOfDays; yd=yd+1) {
			htmlhd=htmlhd+"<th style=\"text-align:center; border:#bbbbbb solid 1px;\" >"+yd+"</th>";
		}
		htmlhd=htmlhd+"<th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">合計回数</th><th style=\"text-align:center; border:#bbbbbb solid 1px;width:5%\" colspan=\"2\">単位数</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">日割</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" colspan=\"2\">付随費用</th>";
		htmlhd=htmlhd+"</tr><tr><th style=\"text-align:center; border:#bbbbbb solid 1px;\" >曜日</th>";

//　ヘッダーの曜日
    	for (yd=1; yd<=NumOfDays; yd=yd+1) {
			var YoubiDate = new Date(y,m,yd);
			var Youbi=YoubiDate.getDay();
			if(Youbi=="0") {
				htmlhd=htmlhd+"<th style=\"text-align:center; border:#bbbbbb solid 1px;\" ><font color=\"red\">"+YoubiDay[Youbi]+"</font></th>";
			} else {
				htmlhd=htmlhd+"<th style=\"text-align:center; border:#bbbbbb solid 1px;\" >"+YoubiDay[Youbi]+"</th>";
			}
		}

//　ヘッダーの集計
		htmlhd=htmlhd+"<th style=\"text-align:center; border:#bbbbbb solid 1px;\">1回</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\">月合計</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\">1回</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\">月合計</th>";
		htmlhd=htmlhd+"</tr></thead>";
		$('#RiyouhyouIchiran').append(htmlhd);


		date = new Date(###TAISHOUMONTH###);
		d = date.getDate();
		m = date.getMonth();
		y = date.getFullYear();

//　ヘッダー作成
//		htmlhd="<thead><tr><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">提供時間帯</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">サービス事業所名</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">サービス内容</th><th style=\"text-align:center; border:#bbbbbb solid 1px;width:3%;\" rowspan=\"2\">保険対象</th><th style=\"text-align:center; border:#bbbbbb solid 1px;width:3%;\" rowspan=\"2\">実績確定</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" >日付</th>";
		htmlhd="<thead><tr><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">提供時間帯</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">サービス事業所名</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">サービス内容</th><th style=\"text-align:center; border:#bbbbbb solid 1px;\" >日付</th>";

		tm = m+1;
		NumOfDays= new Date(y,tm,0).getDate();
		yd=1;
		wn=1;

//　ヘッダーの日付
    	for (yd; yd<=NumOfDays; yd=yd+1) {
			htmlhd=htmlhd+"<th style=\"text-align:center; border:#bbbbbb solid 1px;\" >"+yd+"</th>";
		}
		htmlhd=htmlhd+"<th style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\">合計回数</th>";
		htmlhd=htmlhd+"</tr><tr><th style=\"text-align:center; border:#bbbbbb solid 1px;\" >曜日</th>";

//　ヘッダーの曜日
    	for (yd=1; yd<=NumOfDays; yd=yd+1) {
			var YoubiDate = new Date(y,m,yd);
			var Youbi=YoubiDate.getDay();
			if(Youbi=="0") {
				htmlhd=htmlhd+"<th style=\"text-align:center; border:#bbbbbb solid 1px;\" ><font color=\"red\">"+YoubiDay[Youbi]+"</font></th>";
			} else {
				htmlhd=htmlhd+"<th style=\"text-align:center; border:#bbbbbb solid 1px;\" >"+YoubiDay[Youbi]+"</th>";
			}
		}

//　ヘッダーの集計
		htmlhd=htmlhd+"</tr></thead>";



		$("#RiyouhyouIchiran").children().remove();
		$('#RiyouhyouIchiran').append(htmlhd);

		var htmlval="";

//　展開情報値の設定↓ここから↓
        if(serviced.length>0) {
		for (var s in serviced ) {
			var tmpTimeStart=serviced[s].start.split(":");
			var tmpTimeEnd=serviced[s].end.split(":");
			var tmpMinuteStart=parseInt(tmpTimeStart[0]*60)+parseInt(tmpTimeStart[1]);
			var tmpMinuteEnd=parseInt(tmpTimeEnd[0]*60)+parseInt(tmpTimeEnd[1]);
			var serviceTime=tmpMinuteEnd-tmpMinuteStart;
			var servicefee=0;
                        var serviceshukei="d";
			htmlval=htmlval+"<tr class=\"tryotei\">";

//　提供時間帯設定
    		htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\"><span id=\"start"+numRecord+"\" name=\"start"+numRecord+"\" class=\"teikyoujikanstart\" style=\"width:40px;\">"+serviced[s].start+"</span>～<span id=\"end"+numRecord+"\" name=\"end"+numRecord+"\" class=\"teikyoujikanend\" style=\"width:40px;\">"+serviced[s].end+"</span></td>";

//　供給者選択設定
    		htmlval=htmlval+"<td style=\"text-align:left; border:#bbbbbb solid 1px;\" rowspan=\"2\"><span id=\"Kyokyusha"+numRecord+"\" name=\"Kyokyusha"+numRecord+"\" class=\"Kyokyusha\">";
                var stype="";
    		for (var k in kyoukyusha) {
				if(kyoukyusha[k].id==serviced[s].kyoukyusha){
					htmlval=htmlval+kyoukyusha[k].value;
                                        break;
				}
			}
    		htmlval=htmlval+"</span></td>";

//　サービス内容設定
    		htmlval=htmlval+"<td style=\"text-align:left; border:#bbbbbb solid 1px;\" rowspan=\"2\"><span id=\"ServiceNaiyou"+numRecord+"\" name=\"ServiceNaiyou"+numRecord+"\" class=\"ServiceNaiyou\">";
//　selectedがたったものは変数servicefeeにその単位をセットする（→集計単位をだすため）
    		for (var g in kaigoservice) {
			if(serviced[s].jigyoushatype==kaigoservice[g].jigyoushatype) {
				if(kaigoservice[g].id==serviced[s].id){
					servicefee=parseInt(kaigoservice[g].fee);
                                        serviceshukei=kaigoservice[g].calcunit;
					htmlval=htmlval+kaigoservice[g].value;
                                        break;
				}
			}
		}
    		htmlval=htmlval+"</span></td>";


//　保険者選択設定
//　実績入力
//            htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\"><input type=\"checkbox\" id=\"jissekikakuteicheck"+numRecord+"\" name=\"jissekikakuteicheck"+numRecord+"\" value=\"1\" class=\"jissekikakuteicheck\" ></td>";


//　各日付ごとにサービス実施の設定を行う↓ここから↓
//　その月の全日数から１日ごとに曜日と週を確認して、inputデータの内容と合えば、1をセットし、flgをたてて、kaisuを1増やす（→集計のため）

			htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\">予定</td>";
			wn=1;
			var kaisu=0;
                        var scheck="0";
    		for (yd=1; yd<=NumOfDays; yd=yd+1) {
				var YoubiDate = new Date(y,m,yd);
				var Youbi=YoubiDate.getDay();
				var flg="0";
                var weekyoubiArr=serviced[s].weekyoubi.split(",");
                for(var wya=0;wya<weekyoubiArr.length;wya++) {
					if(weekyoubiArr[wya].substr(1,1).match(/1/) && Youbi=='1'){
						if(weekyoubiArr[wya].substr(0,1).match(/a/) && wn=='1'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/b/) && wn=='2'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/c/) && wn=='3'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/d/) && wn=='4'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/e/) && wn=='5'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
					}
					if(weekyoubiArr[wya].substr(1,1).match(/2/) && Youbi=='2'){
						if(weekyoubiArr[wya].substr(0,1).match(/a/) && wn=='1'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					kaisu++;
	    					flg="1";
						}
						if(weekyoubiArr[wya].substr(0,1).match(/b/) && wn=='2'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/c/) && wn=='3'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/d/) && wn=='4'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/e/) && wn=='5'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
					}
					if(weekyoubiArr[wya].substr(1,1).match(/3/) && Youbi=='3'){
						if(weekyoubiArr[wya].substr(0,1).match(/a/) && wn=='1'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/b/) && wn=='2'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/c/) && wn=='3'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/d/) && wn=='4'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/e/) && wn=='5'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
					}
					if(weekyoubiArr[wya].substr(1,1).match(/4/) && Youbi=='4'){
						if(weekyoubiArr[wya].substr(0,1).match(/a/) && wn=='1'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/b/) && wn=='2'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/c/) && wn=='3'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/d/) && wn=='4'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/e/) && wn=='5'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
					}
					if(weekyoubiArr[wya].substr(1,1).match(/5/) && Youbi=='5'){
						if(weekyoubiArr[wya].substr(0,1).match(/a/) && wn=='1'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/b/) && wn=='2'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/c/) && wn=='3'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/d/) && wn=='4'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/e/) && wn=='5'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
					}
					if(weekyoubiArr[wya].substr(1,1).match(/6/) && Youbi=='6'){
						if(weekyoubiArr[wya].substr(0,1).match(/a/) && wn=='1'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/b/) && wn=='2'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/c/) && wn=='3'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/d/) && wn=='4'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/e/) && wn=='5'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
					}
					if(weekyoubiArr[wya].substr(1,1).match(/0/) && Youbi=='0'){
                                                if(scheck=='1') {
                                                    swn=wn+1;
                                                } else {
                                                    swn=wn;
                                                }
						if(weekyoubiArr[wya].substr(0,1).match(/a/) && swn=='1'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/b/) && swn=='2'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/c/) && swn=='3'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/d/) && swn=='4'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
						if(weekyoubiArr[wya].substr(0,1).match(/e/) && swn=='5'){
							htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">1</span></td>";
	    					flg="1";
	    					kaisu++;
						}
					}
                }
//　サービスがあたらなかった(flg=0)の場合は何もセットしない
				if(flg=="0") {
    				htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+serviced[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\"></span></td>";
				}

//　日曜日(Youbi=0、日曜日始まりでない場合)となった段階でwn(週数)を1増やす。
				if(Youbi==0&&yd!=1) {
					wn=wn+1;
				} else if(Youbi==0&&yd==1) {
                                        scheck='1';
                                }
			}

//  保存されている単位をセットする
                        if (serviced[s].firsttani!="") {
                            servicefee=serviced[s].firsttani;
                        }
//　集計（集計単位によって異なる）
                        var goukeikingaku=0;
                        if(serviceshukei=="m") {
                            goukeikingaku=servicefee;
                        } else {
                            goukeikingaku=servicefee*kaisu;
                        }                        
			var pluskingaku=serviced[s].plusfee*kaisu;
			htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\" class=\"YoteiGoukei\">"+kaisu+"</td>";
			htmlval=htmlval+"</tr><tr class=\"trjisseki\">";
			htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\">実績</td>";
    		for (yd=1; yd<=NumOfDays; yd=yd+1) {
				htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span name=\"RiyouJisseki\" class=\"Jisseki"+yd+"\" style=\"width:100%;\"></span></td>";
			}
			htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\" class=\"JissekiGoukei\">0</td><td style=\"text-align:center; border:#bbbbbb solid 1px;\" class=\"JissekiTaniGoukei\">0</td><td style=\"text-align:center; border:#bbbbbb solid 1px;\" class=\"JissekiFuzuiGoukei\">0</td>";
			htmlval=htmlval+"</tr>";
			yoteigoukei=0;
                        yoteifuzui=0;

            numRecord++;
		}
		

		$('#RiyouhyouIchiran').append(htmlval);
                $('.teikyoujikanstart').live('keyup',function() {
                   var teikyostartidx=$('.teikyoujikanstart').index(this);
                   setKaigoServicePulldown(teikyostartidx);
                });

                $('.teikyoujikanend').live('keyup',function() {
                   var teikyoendidx=$('.teikyoujikanend').index(this);
                   setKaigoServicePulldown(teikyoendidx);
                });

                $('.Kyokyusha').live('change',function() {
                   var kyokyushaidx=$('.Kyokyusha').index(this);
                   for(ky in kyoukyusha) {
                       if(kyoukyusha[ky].id==$('.Kyokyusha').eq(kyokyushaidx).val()) {
                          $(".ServiceType").eq(kyokyushaidx).val(kyoukyusha[ky].jigyoushatype);
                          break;
                       }
                   }
                   setKaigoServicePulldown(kyokyushaidx);
                });

                $('.ServiceNaiyou').live('change',function() {
                   var snidx=$('.ServiceNaiyou').index(this);
                   var snid=$('.ServiceNaiyou').eq(snidx).val();
                   for(k in kaigoservice) {
                      if(kaigoservice[k].id==snid) {
                         $('.ClServiceTani').eq(snidx).val(kaigoservice[k].fee);
                         break;
                      }
                   }
                });
		}
		
		if(youkaigodod.length>0) {
		if(youkaigodod[0].riyougendo<yoteigoukei) {
			$('#YoteiGoukeiGendo').val(youkaigodod[0].riyougendo);
			yoteinokori=0;
		} else {
			$('#YoteiGoukeiGendo').val(yoteigoukei);
			yoteinokori=parseInt(youkaigodod[0].riyougendo)-parseInt(yoteigoukei);
		}
		}

//　作成済みの設定↓ここから↓
        if(sakuseid.length>0) {
		for (var s in sakuseid ) {
			var tmpTimeStart=sakuseid[s].start.split(":");
			var tmpTimeEnd=sakuseid[s].end.split(":");
			var tmpMinuteStart=parseInt(tmpTimeStart[0]*60)+parseInt(tmpTimeStart[1]);
			var tmpMinuteEnd=parseInt(tmpTimeEnd[0]*60)+parseInt(tmpTimeEnd[1]);
			var serviceTime=tmpMinuteEnd-tmpMinuteStart;
			var servicefee=0;
                        var serviceshukei="d";
			htmlval=htmlval+"<tr class=\"tryotei\">";

//　提供時間帯設定
    		htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\"><span id=\"start"+numRecord+"\" name=\"start"+numRecord+"\" style=\"width:40px;\" class=\"teikyoujikanstart\" >"+sakuseid[s].start+"</span>～<span id=\"end"+numRecord+"\" name=\"end"+numRecord+"\" style=\"width:40px;\" class=\"teikyoujikanend\" >"+sakuseid[s].end+"</span></td>";

//　供給者選択設定
    		htmlval=htmlval+"<td style=\"text-align:left; border:#bbbbbb solid 1px;\" rowspan=\"2\"><span id=\"Kyokyusha"+numRecord+"\" name=\"Kyokyusha"+numRecord+"\" class=\"Kyokyusha\" >";
                var stype="";
    		for (var k in kyoukyusha) {
				if(kyoukyusha[k].id==sakuseid[s].kyoukyusha){
					htmlval=htmlval+kyoukyusha[k].value;
                                        break;
				}
			}
    		htmlval=htmlval+"</span></td>";

//　サービス内容設定
    		htmlval=htmlval+"<td style=\"text-align:left; border:#bbbbbb solid 1px;\" rowspan=\"2\"><span id=\"ServiceNaiyou"+numRecord+"\" name=\"ServiceNaiyou"+numRecord+"\" class=\"ServiceNaiyou\" >";
//　selectedがたったものは変数servicefeeにその単位をセットする（→集計単位をだすため）
    		for (var g in kaigoservice) {
			if(sakuseid[s].jigyoushatype==kaigoservice[g].jigyoushatype) {
				if(kaigoservice[g].id==sakuseid[s].id){
					servicefee=parseInt(kaigoservice[g].fee);
                                        serviceshukei=kaigoservice[g].calcunit;
					htmlval=htmlval+kaigoservice[g].value;
                                        break;
				}
			}
		}
    		htmlval=htmlval+"</span></td>";


//　保険者選択設定
//　実績入力
//            if(sakuseid[s].jissekikakutei=="1") {
//                htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\"><input type=\"checkbox\" id=\"jissekikakuteicheck"+numRecord+"\" name=\"jissekikakuteicheck"+numRecord+"\" value=\"1\" class=\"jissekikakuteicheck\" checked></td>";                
//            } else {
//                htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\" rowspan=\"2\"><input type=\"checkbox\" id=\"jissekikakuteicheck"+numRecord+"\" name=\"jissekikakuteicheck"+numRecord+"\" value=\"1\" class=\"jissekikakuteicheck\"></td>";
//            }


//　各日付ごとにサービス実施の設定を行う↓ここから↓
//　その月の全日数から１日ごとに曜日と週を確認して、inputデータの内容と合えば、1をセットし、flgをたてて、kaisuを1増やす（→集計のため）

			htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\">予定</td>";
			var kaisu=0;
            var yoteidayval = new Array();
            var countday=0;
            yoteidayval = sakuseid[s].yoteidate.split(",");
    		for (yd=1; yd<=NumOfDays; yd=yd+1) {
				if(yoteidayval[countday]!="_"){
					htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+sakuseid[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\">"+yoteidayval[countday]+"</span></td>";
    				        kaisu=parseInt(yoteidayval[countday])+parseInt(kaisu);
				} else {
    				        htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span id=\"riyou"+sakuseid[s].id+yd+"\" name=\"RiyouYotei\" class=\"Riyou"+yd+"\" style=\"width:100%;\"></span></td>";
				}
                countday=yd;
			}

//　集計(集計単位によって異なる)
                        var goukeikingaku=0;
                        if(serviceshukei=="m") {
                            goukeikingaku=servicefee;
                        } else {
                            goukeikingaku=servicefee*kaisu;
                        }
			var pluskingaku=sakuseid[s].plusfee*kaisu;
			htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\">"+kaisu+"</td>";
			htmlval=htmlval+"</tr><tr class=\"trjisseki\">";

//			yoteigoukei=parseInt(yoteigoukei)+parseInt(goukeikingaku)+parseInt(pluskingaku);
			yoteigoukei=parseInt(yoteigoukei)+parseInt(goukeikingaku);
                        yoteifuzui=parseInt(yoteifuzui)+parseInt(pluskingaku);

			htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\">実績</td>";
            var jissekidayval = new Array();
            jissekidayval = sakuseid[s].jissekidate.split(",");
            countday=0;
            kaisu=0;
    		for (yd=1; yd<=NumOfDays; yd=yd+1) {
				if(jissekidayval[countday]!="_"){
				    htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span name=\"RiyouJisseki\" class=\"Jisseki"+yd+"\" style=\"width:100%;\">"+jissekidayval[countday]+"</span></td>";
				    kaisu=parseInt(jissekidayval[countday])+parseInt(kaisu);
                } else {
				    htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\"><span name=\"RiyouJisseki\" class=\"Jisseki"+yd+"\" style=\"width:100%;\"></span></td>";
                }
                countday=yd;
			}

//  保存されている単位をセットする
                        if (sakuseid[s].firsttani!="") {
                            servicefee=sakuseid[s].firsttani;
                        }
//　集計(集計単位によって異なる)
                        var goukeikingaku=0;
                        if(serviceshukei=="m") {
                            goukeikingaku=servicefee;
                        } else {
                            goukeikingaku=servicefee*kaisu;
                        }
			pluskingaku=sakuseid[s].plusfee*kaisu;
			htmlval=htmlval+"<td style=\"text-align:center; border:#bbbbbb solid 1px;\" class=\"JissekiGoukei\">"+kaisu+"</td>";
			htmlval=htmlval+"</tr>";
//            jissekigoukei=parseInt(jissekigoukei)+parseInt(goukeikingaku)+parseInt(pluskingaku);
            jissekigoukei=parseInt(jissekigoukei)+parseInt(goukeikingaku);
            jissekifuzui=parseInt(jissekifuzui)+parseInt(pluskingaku);

            numRecord++;
		}
		

		$('#RiyouhyouIchiran').append(htmlval);

		}
		
		if(youkaigodod.length>0) {
            // 予定
			if(youkaigodod[0].riyougendo<yoteigoukei) {
				$('#YoteiGoukeiGendo').html(youkaigodod[0].riyougendo);
				yoteinokori=0;
			} else {
				$('#YoteiGoukeiGendo').html(yoteigoukei);
				yoteinokori=parseInt(youkaigodod[0].riyougendo)-parseInt(yoteigoukei);
			}
            // 実績
			$('#JissekiGoukeiTotal').html(jissekigoukei);
			jissekinokori=parseInt(youkaigodod[0].riyougendo)-parseInt(jissekigoukei);
		}


		$('#YoteiNokori').html(yoteinokori);
		$('#YoteiGoukeiFull').html(yoteigoukei);
		$('#JissekiNokori').html(jissekinokori);
		$('#JissekiGoukeiFull').html(jissekigoukei);
		$('#YoteiFuzui').html(yoteifuzui);
		$('#JissekiFuzui').html(jissekifuzui);


        //  介護サービス自動選択制御関数
        function setKaigoServicePulldown(idx) {
			$('.ServiceNaiyou').eq(idx).children().remove();
    		var StartTime=$(".teikyoujikanstart").eq(idx).val().split(":");
    		var EndTime=$(".teikyoujikanend").eq(idx).val().split(":");
    		var StartMinutes=StartTime[0]*60+parseInt(StartTime[1]);
    		var EndMinutes=EndTime[0]*60+parseInt(EndTime[1]);
    		var KikanMinutes=parseInt(EndMinutes)-parseInt(StartMinutes);
			var JigyoushaType;
			var JigyoushaScale;
			var JigyoushaFacilityType;

			for (var kk in kyoukyusha) {
				if(kyoukyusha[kk].id==$(".Kyokyusha").eq(idx).val()) {
				    JigyoushaType=kyoukyusha[kk].jigyoushatype;
				    JigyoushaScale=kyoukyusha[kk].scale;
				    JigyoushaFacilityType=kyoukyusha[kk].facilitytype;
				    areatanka=kyoukyusha[kk].areatanka;
				    servicemanager=kyoukyusha[kk].servicemanager;
                                    douitsu=kyoukyusha[kk].douitsu;
                                    ketsuin=kyoukyusha[kk].ketsuin;
                                    facilityunit=kyoukyusha[kk].facilityunit;
                                    nightcare=kyoukyusha[kk].nightcare;
    				break;
				}
			}

			for (var ks in kaigoservice) {
				if(kaigoservice[ks].jigyoushatype==JigyoushaType) {
//  通所介護、通所リハビリ
					if(kaigoservice[ks].jigyoushatype==15||kaigoservice[ks].jigyoushatype==16) {
					    if(kaigoservice[ks].kaigodo==youkaigodod[0].kaigodo&&kaigoservice[ks].facilitytype==JigyoushaFacilityType) {
							if(kaigoservice[ks].min<=KikanMinutes&&KikanMinutes<kaigoservice[ks].max) {
							    $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
							}
						}
					} else if(kaigoservice[ks].jigyoushatype==11) {
//                                            if(kaigoservice[ks].scale==JigyoushaScale&&kaigoservice[ks].facilitytype==JigyoushaFacilityType&&kaigoservice[ks].servicemanager==servicemanager&&kaigoservice[ks].douitsu==douitsu) {
                                            if(kaigoservice[ks].scale==JigyoushaScale&&kaigoservice[ks].servicemanager==servicemanager&&kaigoservice[ks].douitsu==douitsu) {
//  訪問介護
						if(kaigoservice[ks].min<=KikanMinutes&&KikanMinutes<kaigoservice[ks].max) {
                                                    if((StartTime[0]>17&&StartTime[0]<22)||(StartTime[0]>5&&StartTime[0]<8)) {
                                                        if(kaigoservice[ks].asayoru=="2") {
						           $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                                        }
                                                    } else if(StartTime[0]>21||StartTime[0]<6) {
                                                        if(kaigoservice[ks].shinya=="2") {
						           $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                                        }
                                                    } else {
                                                        if(kaigoservice[ks].shinya=="1"&&kaigoservice[ks].asayoru=="1") {
						           $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                                        }
                                                    }
						} else {
//　時間に関係ない項目（通院介助など）
							if(kaigoservice[ks].min==="_"&&kaigoservice[ks].max==="_") {
							    $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
							}
						}
                                            }
					} else if(kaigoservice[ks].jigyoushatype==13) {
                                            if(kaigoservice[ks].scale==JigyoushaScale&&kaigoservice[ks].facilitytype==JigyoushaFacilityType) {
//  訪問看護
						if(kaigoservice[ks].min<=KikanMinutes&&KikanMinutes<kaigoservice[ks].max) {
						    $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");						
						} else {
//　時間に関係ない項目（通院介助など）
							if(kaigoservice[ks].min==="_"&&kaigoservice[ks].max==="_") {
							    $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
							}
						}
                                            }
//  短期入所生活
                                        } else if(kaigoservice[ks].jigyoushatype==21) {
                                           if((JigyoushaFacilityType=="1" || JigyoushaFacilityType=="5" || JigyoushaFacilityType=="7")&&kaigoservice[ks].facilitytype=="1") {
                                             if(kaigoservice[ks].kaigodo==youkaigodod[0].kaigodo) {
                                                if(kaigoservice[ks].ketsuin=="1"&&ketsuin=="1") {
                                                   if(kaigoservice[ks].facilityunit==facilityunit&&kaigoservice[ks].nightcare==nightcare) {
                                                     $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                                   }
                                                } else if ((kaigoservice[ks].ketsuin=="2" || kaigoservice[ks].ketsuin=="3")&&ketsuin=="2") {
                                                   if(kaigoservice[ks].facilityunit==facilityunit&&kaigoservice[ks].nightcare==nightcare) {
                                                     $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                                   }
                                                }
                                             }
                                           } else if ((JigyoushaFacilityType=="2" || JigyoushaFacilityType=="6" || JigyoushaFacilityType=="8")&&kaigoservice[ks].facilitytype=="2") {
                                             if(kaigoservice[ks].kaigodo==youkaigodod[0].kaigodo) {
                                                if(kaigoservice[ks].ketsuin=="1"&&ketsuin=="1") {
                                                   if(kaigoservice[ks].facilityunit==facilityunit&&kaigoservice[ks].nightcare==nightcare) {
                                                     $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                                   }
                                                } else if ((kaigoservice[ks].ketsuin=="2" || kaigoservice[ks].ketsuin=="3")&&ketsuin=="2") {
                                                   if(kaigoservice[ks].facilityunit==facilityunit&&kaigoservice[ks].nightcare==nightcare) {
                                                     $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                                   }
                                                }
                                             }
                                           } else if ((JigyoushaFacilityType == "3" || JigyoushaFacilityType == "5" || JigyoushaFacilityType == "6")&&kaigoservice[ks].facilitytype=="3") {
                                             if(kaigoservice[ks].kaigodo==youkaigodod[0].kaigodo) {
                                                if(kaigoservice[ks].ketsuin=="1"&&ketsuin=="1") {
                                                   if(kaigoservice[ks].facilityunit==facilityunit&&kaigoservice[ks].nightcare==nightcare) {
                                                     $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                                   }
                                                } else if ((kaigoservice[ks].ketsuin=="2" || kaigoservice[ks].ketsuin=="3")&&ketsuin=="2") {
                                                   if(kaigoservice[ks].facilityunit==facilityunit&&kaigoservice[ks].nightcare==nightcare) {
                                                     $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                                   }
                                                }
                                             }
                                           } else if ((JigyoushaFacilityType == "4" || JigyoushaFacilityType == "7" || JigyoushaFacilityType == "8")&&kaigoservice[ks].facilitytype=="4") {
                                             if(kaigoservice[ks].kaigodo==youkaigodod[0].kaigodo) {
                                                if(kaigoservice[ks].ketsuin=="1"&&ketsuin=="1") {
                                                   if(kaigoservice[ks].facilityunit==facilityunit&&kaigoservice[ks].nightcare==nightcare) {
                                                     $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                                   }
                                                } else if ((kaigoservice[ks].ketsuin=="2" || kaigoservice[ks].ketsuin=="3")&&ketsuin=="2") {
                                                   if(kaigoservice[ks].facilityunit==facilityunit&&kaigoservice[ks].nightcare==nightcare) {
                                                     $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                                   }
                                                }
                                             }
                                           }
//  訪問看護
                                        } else if(kaigoservice[ks].jigyoushatype==14) {
                                             if(kaigoservice[ks].douitsu==douitsu&&kaigoservice[ks].facilitytype==JigyoushaFacilityType) {
                                                $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                             }
                                        } else {
//  訪問介護、訪問看護、通所介護、通所リハビリ以外
                                             $('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
                                        }
				} else {
//　時間や規模などに関係ない項目
				    if(kaigoservice[ks].jigyoushatype==JigyoushaType&&kaigoservice[ks].scale=="_"&&kaigoservice[ks].facilitytype=="_"&&kaigoservice[ks].servicemanager=="_") {
				    	$('.ServiceNaiyou').eq(idx).append("<option value=\""+kaigoservice[ks].id+"\">"+kaigoservice[ks].value+"</option>");
					}
				}
			}
			for (var kn in kaigoservice) {
                 if($('.ServiceNaiyou').eq(idx).children(':selected').val()==kaigoservice[kn].id) {
                     $('.ClServiceTani').eq(idx).val(kaigoservice[kn].fee);
                     break;
                 }
            }
        }

                function inputValidate() {
                    var error_flg="0";
                    if($('#JissekiKakuteiFlg').attr('checked') == "checked") {
                       $('.jissekikakuteicheck').each(function(i) {
                           if($('.jissekikakuteicheck').eq(i).attr('checked') != "checked") {
                               error_msg="実績チェックがされていないサービスがあります。";
                               error_flg="1";
                           }
                       }); 
                    }

                    if(error_flg=="1") {
                        return false;
                    } else {
                        return true;
                    }
                    
                }

	});
	
	</script>

    <!-- Demo page code -->

    <style type="text/css">
        #line-chart {
            height:300px;
            width:800px;
            margin: 0px auto;
            margin-top: 1em;
        }
    </style>

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="lib/html5.js"></script>
    <![endif]-->

  </head>

  <!--[if lt IE 7 ]> <body class="ie ie6"> <![endif]-->
  <!--[if IE 7 ]> <body class="ie ie7 "> <![endif]-->
  <!--[if IE 8 ]> <body class="ie ie8 "> <![endif]-->
  <!--[if IE 9 ]> <body class="ie ie9 "> <![endif]-->
  <!--[if (gt IE 9)|!(IE)]><!--> 
  <body class=""> 
  <!--<![endif]-->
    <div class="">
		<div class=""style="min-width:1536px;">
            <form id="frmRiyouhyou" name="frmRiyouhyou">
            <input type="hidden" name="MODE" value="" />
            <input type="hidden" name="Riyoushaid" value="###RIYOUSHAID###" />
            <input type="hidden" name="USER_ID" value="###USERID###" />
            <input type="hidden" name="hdKeikakuSakuseiDate" value="###HDKEIKAKUSAKUSEIDATE###" >
            <input type="hidden" name="hdKijunDate" value="###HDKEIKAKUSAKUSEIDATE###" >
            <input type="hidden" name="KeikakuSakuseiDate" value="###KEIKAKUSAKUSEIDATE###">
            <input type="hidden" name="KijunDate" value="###KEIKAKUSAKUSEIDATE###">
            <input type="hidden" name="userid"  value="###USERID###" />
            <input type="hidden" name="password" value="###PASSWORD###" />
            <input type="hidden" name="shisetsu" value="###SHISETSUID###" />
			<div>
                   <table style="width:100%;margin-top:1em;">
                     <tr>
<!--                        <td style="margin-top:.5em;border:1px solid #bbbbbb;padding:0px 10px 0px 10px;width:6%">第６表</td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;width:2%"></td>
                        <td style="margin-top:.5em;border:1px solid #bbbbbb;padding:0px 10px 0px 10px;width:10%">
                           <span id="spnNinteizumi" name="spnNinteizumi">認定済</span>・
                           <span id="spnNinteiMaru" name="spnNinteiMaru" style="margin-left:-50px;font-size:20px">〇</span>
                           <span id="spnShinseichu" name="spnShinseichu" style="margin-left:20px">申請中</span>
                           <span id="spnShinseiMaru" name="spnShinseiMaru" style="margin-left:-40px;font-size:20px">　</span>
                        </td> -->
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;width:10%;"></td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;width:20%;text-align:right;font-size:20px;">
                           <span id="taishouwareki" name="taishouwareki" style=""></span><span id="taishouyear" name="taishouyear" style="" ></span>年<span id="taishoumonth" name="taishoumonth" style=""></span>月分
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;width:40%;text-align:center;"><font style="font-size:20px">居宅サービス予定・実績表</font></td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;width:30%;"></td>
<!--		<td style="margin-top:.5em;border:1px solid #bbbbbb;padding:0px 10px 0px 10px;text-align:right"><font style="">居宅介護支援事業者　→　利用者</font></td>   -->
                     </tr>
                   </table>
                   <table style="width:100%;margin-top:1em;">
                     <tr>
                        <td style="margin-top:.5em;padding:10px 10px 0px 10px;border:1px solid #bbbbbb;width:7%" rowspan="2">
                         保険者番号
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:15%;font-size:20px" rowspan="2" colspan="3">###HOKENJABANGOU###</td>
                        <td style="margin-top:.5em;padding:10px 10px 0px 10px;border:1px solid #bbbbbb;width:10%" rowspan="2">
                         保険者名
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:16%" rowspan="2">###HOKENJAMEI###</td>
                        <td style="margin-top:.5em;padding:0px 0px 0px 0px;border:1px solid #bbbbbb;width:10%;font-size:10px" rowspan="2">
                         居宅介護支援事業者事業所名<br />担当者名
                        </td>
                        <td style="margin-top:.5em;padding:0px 0px 0px 0px;border:1px solid #bbbbbb;width:20%;font-size:10px" colspan="2" rowspan="2">
                         ###KYOTAKUKAIGOSHIENJIGYOUSHAMEI###
                         <br />
                         電話番号　###KYOTAKUKAIGOSHIENJIGYOUSHATEL###
                         <br />
                         担当者名　###CAREMANAGERNAME###
                        </td>
                        <td style="margin-top:.5em;padding:10px 10px 0px 10px;border:1px solid #bbbbbb;width:7%" rowspan="2">
                         作成年月日
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:10%" rowspan="2" colspan="2">###RIYOUHYOUSAKUSEIDATE###</td>
                        <td style="margin-top:.5em;padding:0px 0px 0px 0px;border:1px solid #bbbbbb;width:5%">
                         利用者確認
                        </td>
                     </tr>
                     <tr>
                        <td style="margin-top:.5em;padding:0px 0px 0px 0px;border:1px solid #bbbbbb;"></td>
                     </tr>
                     <tr>
                        <td style="margin-top:.5em;padding:10px 10px 0px 10px;border:1px solid #bbbbbb;width:7%" rowspan="2">
                         被保険者番号
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:15%;font-size:20px" colspan="3" rowspan="2">###HIHOKENJABANGOU###</td>
                        <td style="margin-top:.5em;padding:10px 10px 0px 10px;border:1px solid #bbbbbb;width:10%">
                         フリガナ
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:16%">
                         ###SHIMEIFURIGANA###
                        </td>
                        <td style="margin-top:.5em;padding:10px 10px 0px 10px;border:1px solid #bbbbbb;width:10%" rowspan="2">
                         保険者確認印
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:20%" colspan="2" rowspan="2">
                        </td>
                        <td style="margin-top:.5em;padding:10px 10px 0px 10px;border:1px solid #bbbbbb;width:7%" rowspan="2">
                         届出年月日
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:15%" colspan="3" rowspan="2"></td>
                     </tr>
                     <tr>
                        <td style="margin-top:.5em;padding:10px 10px 0px 10px;border:1px solid #bbbbbb;width:10%">
                         被保険者氏名
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:16%">
                         ###RIYOUSHAMEI###
                        </td>
                     </tr>
                     <tr>
                        <td style="margin-top:.5em;padding:10px 10px 0px 10px;border:1px solid #bbbbbb;width:7%" rowspan="3">
                         生年月日
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:10%;" rowspan="3">###SEINENGAPPI###</td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:2%;" rowspan="3">性別</td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:3%;" rowspan="3">###SEIBETSU###</td>
                        <td style="margin-top:.5em;padding:10px 0px 0px 10px;border:1px solid #bbbbbb;width:10%;font-size:12px">
                         要介護状態区分
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:16%">
                           <span id="spnKaigo1" name="spnKaigo1">１</span>
                           <span id="spnKaigo1Maru" name="spnKaigo1MaruMaru" style="margin-left:-20px;font-size:20px">###KAIGO1MARU###</span>
                           <span id="spnKaigo2" name="spnKaigo2">２</span>
                           <span id="spnKaigo2Maru" name="spnKaigo2MaruMaru" style="margin-left:-20px;font-size:20px">###KAIGO2MARU###</span>
                           <span id="spnKaigo3" name="spnKaigo3">３</span>
                           <span id="spnKaigo3Maru" name="spnKaigo3MaruMaru" style="margin-left:-20px;font-size:20px">###KAIGO3MARU###</span>
                           <span id="spnKaigo4" name="spnKaigo4">４</span>
                           <span id="spnKaigo4Maru" name="spnKaigo4MaruMaru" style="margin-left:-20px;font-size:20px">###KAIGO4MARU###</span>
                           <span id="spnKaigo5" name="spnKaigo5">５</span>
                           <span id="spnKaigo5Maru" name="spnKaigo5MaruMaru" style="margin-left:-20px;font-size:20px">###KAIGO5MARU###</span>
                        </td>
                        <td style="margin-top:.5em;padding:10px 10px 0px 10px;border:1px solid #bbbbbb;width:10%;" rowspan="3">
                         区分支給限度基準額
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:15%" rowspan="3">
                         <span id="RiyouGendo" name="RiyouGendo" style="width:80px"></span>単位／月
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:5%" rowspan="3">
                         限度額適用期間
                        </td>
                        <td style="margin-top:.5em;padding:10px 10px 0px 10px;border:1px solid #bbbbbb;width:12%" rowspan="3" colspan="2">
                         ###FROMNINTEIKIKAN###から###TONINTEIKIKAN###まで
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:7%;font-size:11px" rowspan="3">前月までの短期入所利用日数</td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:3%" rowspan="3">0日</td>
                     </tr>
                     <tr>
                        <td style="margin-top:.5em;padding:10px 0px 0px 10px;border:1px solid #bbbbbb;width:10%;font-size:12px">
                         変更後<br />要介護状態区分
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:16%">
                           <span id="spnHenkoKaigo1" name="spnHenkoKaigo1">１</span>
                           <span id="spnHenkoKaigo1Maru" name="spnHenkoKaigo1MaruMaru" style="margin-left:-20px;font-size:20px">###HENKAKAIGO1MARU###</span>
                           <span id="spnHenkoKaigo2" name="spnHenkoKaigo2">２</span>
                           <span id="spnHenkoKaigo2Maru" name="spnHenkoKaigo2MaruMaru" style="margin-left:-20px;font-size:20px">###HENKAKAIGO2MARU###</span>
                           <span id="spnHenkoKaigo3" name="spnHenkoKaigo3">３</span>
                           <span id="spnHenkoKaigo3Maru" name="spnHenkoKaigo3MaruMaru" style="margin-left:-20px;font-size:20px">###HENKAKAIGO3MARU###</span>
                           <span id="spnHenkoKaigo4" name="spnHenkoKaigo4">４</span>
                           <span id="spnHenkoKaigo4Maru" name="spnHenkoKaigo4MaruMaru" style="margin-left:-20px;font-size:20px">###HENKAKAIGO4MARU###</span>
                           <span id="spnHenkoKaigo5" name="spnHenkoKaigo5">５</span>
                           <span id="spnHenkoKaigo5Maru" name="spnHenkoKaigo5MaruMaru" style="margin-left:-20px;font-size:20px">###HENKAKAIGO5MARU###</span>
                        </td>
                     </tr>
                     <tr>
                        <td style="margin-top:.5em;padding:10px 0px 0px 10px;border:1px solid #bbbbbb;width:10%;font-size:12px">
                         変更日
                        </td>
                        <td style="margin-top:.5em;padding:0px 10px 0px 10px;border:1px solid #bbbbbb;width:16%">
                            ###NINTEIKIRIKAEBI###
                        </td>
                     </tr>
                   </table>
            </div>
            <div class="clearfix"></div>
            <div style="margin-top:2em">
			<div style="">
				<table id="RiyouhyouIchiran" style="border:#bbbbbb solid 2px;width:100%;">
				</table>
            </div>
<!--            <div>
                   <table style="width:100%;">
                     <tr><td style="width:60%"></td>
                         <td style="text-align:left">
                            <p>私は居宅サービス計画の説明を受け、内容に同意し、交付を受けました。</p>
                            <p style="text-align:center"><span style="margin-right:3em">平成</span><span style="margin-right:3em">年</span><span style="margin-right:3em">月</span><span style="margin-right:3em">日</span></p>
                            <p style="text-align:center"><span style="margin-right:20em">氏名</span><span>印</span></p>
                         </td>
                     </tr>
                   </table>
            </div> -->
	        </div>
            </form>
	    </div>
	</div>    


    <script src="###DOMAIN###/js/bootstrap.js"></script>
    <script type="text/javascript">
        $("[rel=tooltip]").tooltip();
        $(function() {
            $('.demo-cancel-click').click(function(){return false;});
        });
    </script>
    
  </body>
</html>


